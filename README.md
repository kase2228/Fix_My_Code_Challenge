Codes have been rewritten so as to debug the error
